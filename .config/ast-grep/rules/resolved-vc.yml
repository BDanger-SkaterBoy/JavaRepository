# yaml-language-server: $schema=https://raw.githubusercontent.com/ast-grep/ast-grep/main/schemas/rule.json

id: no-vc-struct
message: Don't use a Vc directly in a struct
note: 'Prefer using ResolvedVc, or add a `// no-resolved-vc(<AUTHOR>): <REASON>` comment'
severity: warning
language: rust

rule:
  pattern:
    context: 'let x: Vc<$A> = 1;'
    selector: generic_type
  inside:
    stopBy: end
    follows:
      kind: attribute_item
      has:
        kind: attribute
        regex: '^turbo_tasks::value$'
fix: ResolvedVc<$A>
